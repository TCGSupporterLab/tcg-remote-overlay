# ホロライブOCGツール仕様

## 1. カード検索エンジン

### 除外ロジック
- **エールカード**: 
    - **データ管理**: 公式サイトとの件数照合（スクレイピング時のスキップ判定）のため、`hololive-cards.json` 内には全件保持されます。
    - **UI表示**: アプリケーション（`useCardSearch.ts`）で `cardType` が「エール」のカードは検索結果から常に除外されます。

### キーワード検索
- **正規化 (Normalization)**: 入力テキストは Unicode正規化 (NFKC) を行い、小文字化します。
- **ひらがな対応**: 検索キーワードとカード名の両方を内部的にカタカナに変換して比較することで、「サクラ」と「さくら」の表記ゆれを吸収してヒットさせます。
- **記号無視照合**: カード名やキーワードに含まれる記号（`・`, `ー`, 空白, `-`, `!`, `?` 等）を除外した状態でも判定を行います。
    - これにより、「じむ」で「ジジ・ムリン」、「ずぶ」で「ローズ・ブラッド...」などの、記号や長音（ー）を挟む検索もヒットするようになります。

### フィルタリング仕様
- **カラーフィルタ (色)**:
    - **単色**: 色文字列が1文字 (`length === 1`)
    - **多色**: 色文字列が2文字以上 (`length >= 2`)
    - **無**: 「◇」記号のみ一致
    - **特定色**: 各色ボタンが押されている場合、`includes` で部分一致判定。
- **タイプフィルタ**:
    - **サポート**: 「サポート」で始まるタイプ（アイテム・イベント等を含む）
    - **LIMITED**: タイプ名に「LIMITED」が含まれるもの
    - **ホロメン / 推しホロメン**: 完全一致
- **Bloomレベルフィルタ**:
    - `Debut`, `1st`, `2nd`, `Spot` の完全一致

## 2. ピン留め機能 (Bookmarks)
- **枚数制限**: 最大 **100枚**。
- **上限到達時**: アラートを表示して追加をブロックします。
- **永続化**: `localStorage` に保存。

## 3. UIと操作
- **無限スクロール**: 50枚ずつの遅延読み込み(`IntersectionObserver`)を採用。
- **キーボードナビゲーション**:
    - `Tab`: 検索タブとピン解除タブの切り替え。
    - `矢印キー (← → ↑ ↓)`: グリッド内のカード選択と自動スクロール。
- **オーバーレイ連携**: 選択されたカードは即座にオーバーレイ窓へ送信され、拡大表示されます。
    - **カード表示レイアウト**: オーバーレイ時、カード画像の上にサイコロが表示されます。
    - **ダイス配置の最適化**: 3Dサイコロがカードの情報を極力遮らないよう、カードの縁（上端または下端）に寄せた配置が行われます。視認性向上のため、サイコロの背景には薄い半透明パネルが配置されます。
    - **機材表示制限**: ホロライブモードではダイスのみを使用するため、オーバーレイ窓（カード表示オフ時含む）およびコントローラー側ではコインの表示が抑制されます。
