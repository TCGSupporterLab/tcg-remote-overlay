# ライフ計算機ウィジェット仕様 (LP Calculator Widget)

## 1. ライフポイント管理 (LP Tracking)
- **初期値**: 8000
- **範囲**: 0 ～ 99999
- **履歴**: 直近10件の変更を各プレイヤーごとにログとして保持。

## 2. 計算機機能 (Calculator)
- **ターゲット管理**: Player 1 または Player 2 を選択（フォーカス）して操作。最後に選択していた状態はセッション間で維持されます。
- **ターゲットのリセット**: `R` キー長押しによる全状態リセット、または設定メニューの「状態リセット」ボタンにより、ターゲットは Player 1 へ初期化されます。
- **演算**: 
    - `+`: 指定値を加算
    - `-` (または Enter): 指定値を減算
    - `÷2`: 現在のライフを半分（端数切り上げ）にする
    - `CLR`: 入力中の値をリセット
- **Undo / Redo**: `Ctrl+Z` / `Ctrl+Y` (および `Ctrl+Shift+Z`) による履歴の戻し・進めに対応（最大履歴件数に準拠）。

| キー | 操作内容 (操作画面) | 操作内容 (オーバーレイ) |
| :--- | :--- | :--- |
| `0 - 9` | 数値入力 | 同左 |
| `+` | 加算実行 | 同左 |
| `-` / `Enter` | 減算実行 | 同左 |
| `/` | ライフ半分 (÷2) | 同左 |
| `.` (テンキー) | ダイスを振る (素早く 2 回でコイン) | 同左 |
| `Delete` / `Backspace` | 入力クリア | 同左 |
| `←` | Target を Player 1 に設定 | (無効) |
| `→` | Target を Player 2 に設定 | (無効) |
| `↑` | (無効) | Target を Player 2 に設定 |
| `↓` | (無効) | Target を Player 1 に設定 |
| `Ctrl + Z` | 元に戻す (Undo) | (無効 - 表示専用) |
| `Ctrl + Y` / `Ctrl + Shift + Z` | やり直し (Redo) | (無効 - 表示専用) |

## 4. ビジュアルとエフェクト
- **フォーカスエフェクト**: ターゲット中のプレイヤー枠が発光し、影（Shadow）が表示されます。
- **オーバーレイ・レイアウト**: 
    - 配信時の視認性を高めるため、**垂直スタック型**（上から P2, ダイス/コイン, P1）のレイアウトを採用。
    - **Player 2 の自動反転**: 垂直スタックレイアウト内では、Player 2 は対面対戦を再現するため内部的に最初から**180度回転**した状態で配置されます。
    - **コンパクト化**: ウィンドウサイズを最小化できるよう、要素間のギャップや余白が最適化されています。
- **操作の共通化**: すべての配置・回転・スケーリング操作は、オーバーレイ窓上でホバー時に表示される共通ハンドル（OverlayWidget）に統合されました。これにより、個別の回転ボタン等は操作画面から削除されています。
- **ネオンデザイン**: オーバーレイ窓ではデジタル風の発光フォント（DigitalDisplay）を使用して視認性を高めています。
