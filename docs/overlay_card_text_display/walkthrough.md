# オーバーレイ・カードテキスト表示機能 実装完了

オーバーレイ画面にカードの画像だけでなく、詳細なテキスト情報を表示できる機能を実装しました。これにより、画像が読みづらい場合や特定の効果テキストを強調したい場合に対応可能となります。

## 変更内容

### 1. 状態管理の拡張 ([useCardSearch.ts](file:///f:/dev/github/RemoteDuelTool/src/hooks/useCardSearch.ts))
- **詳細フィールドの追加**: スクレイパーで抽出した `oshiSkills`, `arts`, `keywords`, `abilityText` 等を `Card` 型に追加しました。
- **表示モードの状態追加**: `overlayDisplayMode` (`'image'` | `'text'`) を導入しました。
- **窓間同期**: `BroadcastChannel` を拡張し、コントローラーでの切り替えがオーバーレイ窓に即座に反映されるようにしました。

### 2. コントローラー UI ([DisplayModeBadge.tsx](file:///f:/dev/github/RemoteDuelTool/src/components/CardSearch/DisplayModeBadge.tsx))
- オーバーレイバッジの隣に、表示モードを切り替えるボタンを追加しました。
- **直感的なUI**: アイコンが「現在の表示状態」を示すように設計されており（画像モード時は画像アイコン、テキストモード時はテキストアイコン）、クリックで他方のモードへ切り替わります。
- [SearchContainer.tsx](file:///f:/dev/github/RemoteDuelTool/src/components/CardSearch/CardSearchContainer.tsx) に統合しました。

### 3. オーバーレイ描画ロジック ([HololiveTools.tsx](file:///f:/dev/github/RemoteDuelTool/src/components/HololiveTools.tsx))
- テキストモード時の専用レイアウトを実装しました：
    - **ヘッダーレイアウトの最適化**: 
        - カードIDおよび属性（色）のテキスト表示を削除し、情報のスリム化を図りました。
        - **カラーコーディング**: カード名の文字色を属性色に合わせて直接変更するようにしました（ボーダー表示は廃止し、よりシンプルなインフォグラフィックに修正）。
        - **クロマキー配慮**: 緑色属性については、OBSのグリーンバック環境を考慮し、純粋な緑ではなくエメラルドグリーン (`Emerald`) を採用することで、情報の消失を防いでいます。
        - カードタイプ（ホロメン、サポート等）を名前の左上に配置し、より直感的にカードの種類を把握できるようにしました。
    - 名前、HP/❤、タイプ、色、ブルームレベルの表示。
    - **推しスキル**: 推しホロメン専用の青ベースのセクション。
    - **アーツ**: コストアイコン、ダメージ、特効、テキストを含む赤ベースのセクション。
    - **キーワード能力**: 黄色で強調された能力説明。
    - **能力テキスト**: サポートカード等。
- **反転表示の対応**: バッジで 180 度回転を選択している場合、テキスト表示も連動して回転します。

## 検証結果

### 動作確認
1.  **モード切り替え**: コントローラーのトグルボタンで、オーバーレイの画像とテキストが即座に切り替わることを確認しました。
2.  **同期**: 複数のウィンドウを開いた状態でも、状態（画像/テキスト、および回転）が正しく同期されます。
3.  **デザインの洗練（角丸・白エッジ・サイズ固定）**: 
    - カード枠の角丸を `3xl` (24px) に強化し、白いエッジを追加して視認性を向上させました。
    - **サイズ固定化**: テキスト量や画像・テキストの切り替えにかかわらず、枠のサイズを `350px x 520px` に完全に固定しました。これにより、カードを切り替えた際の外枠のガタつきを無くし、安定したレイアウトを実現しました。
4.  **回転**: `rotated` モード時、テキストベースのレイアウトも正しく 180 度回転して表示されます。
5.  **カード種別ごとの表示**:
    - **推しホロメン**: HP表記が `❤` になり、スキルが正しく表示されること。
    - **ホロメン**: HP表記が `HP` のままで、アーツコストやダメージが正しく表示されること。
    - **サポートカード**: 能力テキストが表示されること。

---

[ホロライブツールセット仕様書](file:///f:/dev/github/RemoteDuelTool/docs/system_specifications/features/hololive_toolset.md)
