# バトンタッチ情報の抽出と表示 実装完了

ホロメンカードとBuzzホロメンカードに共通する重要な情報である「バトンタッチ（交代コスト）」を、`hololive-cards.json` への追加抽出およびオーバーレイ画面での表示に対応させました。

## 変更内容

### 1. スクレイパーの強化 ([fetch-hololive-data.js](file:///f:/dev/github/RemoteDuelTool/scripts/fetch-hololive-data.js))
- **バトンタッチコストの抽出**: 公式サイトのテキスト表示モードから `バトンタッチ` 項目を検出し、そのコストアイコン（赤、青、緑、黄、紫、白、◇）を `batonTouch` フィールドとして抽出するロジックを追加しました。
- **データ更新**: 開発モード (`DEV=true`) を使用して、全1,777枚のカードデータを最新化しました。
- **GitHub Actions 連携**: 自動データ更新ワークフロー (`update-data.yml`) において、常に最新データを取得するため `DEV=false` を明示的に設定しました。

### 2. 型定義の拡張 ([useCardSearch.ts](file:///f:/dev/github/RemoteDuelTool/src/hooks/useCardSearch.ts))
- `Card` インターフェースに `batonTouch?` プロパティを追加し、型安全性を確保しました。

### 3. オーバーレイ UI の改善 ([HololiveTools.tsx](file:///f:/dev/github/RemoteDuelTool/src/components/HololiveTools.tsx))
- **フッター領域への統合**: ユーザーのフィードバックに基づき、カード下部の「タグ」の右側にバトンタッチ情報を配置しました。
- **ホロメン・Buzzホロメンの特別対応**: これらのカードタイプについては、バトンタッチコストが空であっても項目を常に表示するようにしました。コストが空の場合はアイコン（円形枠）も表示せず、「バトンタッチ」というテキストのみを表示します。これにより、交代可能なカードであることを示しつつ、不要な視覚要素を排除しました。
- **視覚的な表現**: 
    - 「バトンタッチ」というラベルと共に、公式に近い丸いカラーアイコンを表示します。
    - コストの色（赤、青、緑など）に合わせてアイコンの背景色を動的に変更し、直感的にコストを一目で把握できるようにしました。
    - バトンタッチ情報を持たないカード（サポートカードや推しホロメンなど）では、この項目は自動的に非表示になります。

### 5. 仕様書の自動更新 (/update-docs)
- **ホロライブツール仕様 (`hololive_toolset.md`)**: バトンタッチの表示ルール（ホロメン・Buzzは常時表示、コスト0はテキストのみ）および、サイコロの配置調整（枠への密着）の仕様を反映しました。
- **データ形式仕様 (`data_format.md`)**: `batonTouch` フィールドの定義を追記しました。
- **開発ルール (`hololive_data_development_rule.md`)**: GitHub Actions 上で `DEV=false` を使用する運用ルールを追記しました。

## 検証結果

### 動作確認
1. **ホロメンカード**: フッターにタグと並んでバトンタッチ項目が表示されることを確認しました。
2. **コスト空カード**: ホロメン・Buzzホロメンでコストが空の場合、「バトンタッチ」テキストのみが適切に表示されることを確認しました。
3. **サイコロ配置**: サイコロがカード枠の最上部/最下部に隙間なく配置され、カード画像との親和性が向上したことを確認しました。
4. **推しホロメン / サポートカード**: バトンタッチ項目が表示されず、レイアウトが崩れないことを確認しました。
5. **型チェック**: TypeScript のビルドエラーや警告が解消されていることを確認しました。

---

[ホロライブツールセット仕様書](file:///f:/dev/github/RemoteDuelTool/docs/system_specifications/features/hololive_toolset.md)
