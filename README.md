# TCG Remote Overlay


OBSなどの配信ソフトでの使用や、Discord等の画面共有を用いたリモート対戦を強力にサポートする、トレーディングカードゲーム（TCG）用オーバーレイツールです。「遊戯王OCG」および「ホロライブOCG」に対応しています。

## 🌟 主な機能

### 🛰️ 高機能オーバーレイ (OverlayWidget) [NEW]
- **自由自在な配置**: マウス操作でウィジェットを画面内の好きな場所に移動、回転、拡大縮小が可能です。
- **スナップ回転**: 0°/90°/180°/270° に近づくと自動で吸い付くスマート回転機能を搭載。
- **全画面モード**: ブラウザのアドレスバーやタブを隠して、アプリ単体で配信画面のような没入感を実現。
- **レスポンシブ同期**: ウィンドウのサイズを変更しても位置関係が崩れず、設定したスケール感で確実に追従します。

### 🎤 ホロライブモード
- **高速カード検索**: 1,700枚以上の全カードから名称、色、タイプ、Bloomレベルで瞬時にフィルタ。読み仮名（カタカナ/ひらがな）による検索にも対応。
- **ピン留め機能**: 最大1,000枚までのクイックアクセス。同一ID・別絵柄の個別保存に対応。ドラッグ＆ドロップによる自由な並び替え、ダブルクリックによるトグル操作が可能。
- **配信特化表示**: 選択中のカード情報を左側に大きく、ダイス結果をカード縁に配置するなど、視聴者への視認性を追求。
- **キーボード連動**: オーバーレイ窓をアクティブにして数字キーを入力することで、ピン留めカードを瞬時に切り替え（1,000番まで対応）。

### 🃏 遊戯王モード
- **ライフポイント管理**: 直感的な十キー操作による計算機機能、履歴ログ、Undo/Redo対応。
- **オート反転**: Player 2側を自動で180度反転させ、対面対戦の雰囲気を再現。
- **ネオンディスプレイ**: 配信映えするデジタル・ネオンデザインを採用。

### 🎲 共通ツール
- **3D物理演出**: リアルな挙動の3Dダイス、3Dコイントスアニメーション。
- **マルチウィンドウ同期**: `BroadcastChannel API` により、操作画面と表示画面（オーバーレイ）を別ウィンドウに分離して管理可能。
- **単一インスタンスの保護**: アプリケーション名（タイトル）でメイン画面と設定画面を明確に区別。同一種別の画面が重複して開かれた場合、古いセッションを自動終了させる安全装置を搭載。

## 🚀 使い方

### セットアップ

1. **リポジトリをクローン**
   ```bash
   git clone https://github.com/TCGSupporterLab/tcg-remote-overlay.git
   cd tcg-remote-overlay
   ```

2. **依存関係のインストール**
   ```bash
   npm install
   ```

3. **起動**
   ```bash
   npm run dev
   ```

### 配信ソフト（OBS等）での使用

1. **オーバーレイを起動**: アプリ右上の「起動」（タブ単位）または「別窓で起動」（ウィンドウ単位）ボタンをクリックしてオーバーレイを表示します。
2. **OBSに追加**: 「ソース」→「ブラウザ」を追加。
3. **URLを指定**: `http://localhost:5173/?mode=overlay` を入力。
4. **背景透過**: 
   - クロマキーを使いたい場合は、アプリ内の設定から「GB（グリーンバック）」モードを選択。
   - OBS側のプロパティで「カスタムCSS」を調整、またはクロマキーフィルタを追加してください。

## ⌨️ キーボードショートカット

| キー | 動作 |
| --- | --- |
| `0-9` | 遊戯王: 数字入力 / ホロライブ: ピン留めカード選択 (連続入力で多桁対応) |
| `+` / `-` | 遊戯王: 加算 / 減算 |
| `Enter` | 遊戯王: 減算実行 |
| `/` | 遊戯王: ライフを半分にする |
| `.` (テンキー) | ダイスを振る (遊戯王のみ: 素早く2回でコイン) |
| `O` | ホロライブ: SPマーカーの表示/非表示をトグル |
| `D` | ダイスを振る |
| `C` | コインを投げる |
| `V` | ビデオソース切替 (Camera / Screen / OFF) |
| `M` | ビデオ反転モード切替 |
| `A` | ビデオ調整モードの開始/終了 (オーバーレイ窓上でのホイールクリックでも可) |
| `Ctrl + Z / Y` | 遊戯王: ライフのUndo / Redo |

## 🛠 技術スタック

- **Framework**: React 18 (Vite)
- **Language**: TypeScript
- **Styling**: Vanilla CSS / Tailwind CSS
- **Animation**: CSS Transform / Framer Motion (予定)
- **Icons**: Lucide React
- **Sync**: BroadcastChannel API

## 📝 ライセンス

MIT License
